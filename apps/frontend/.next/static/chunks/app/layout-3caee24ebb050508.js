(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7010:function(e,t,n){Promise.resolve().then(n.bind(n,6883)),Promise.resolve().then(n.bind(n,2338)),Promise.resolve().then(n.bind(n,8723)),Promise.resolve().then(n.t.bind(n,829,23)),Promise.resolve().then(n.bind(n,9613)),Promise.resolve().then(n.bind(n,7793)),Promise.resolve().then(n.bind(n,1950)),Promise.resolve().then(n.bind(n,9015)),Promise.resolve().then(n.bind(n,3317)),Promise.resolve().then(n.bind(n,9335)),Promise.resolve().then(n.t.bind(n,4065,23))},6883:function(e,t,n){"use strict";n.r(t),n.d(t,{ClientSessionProvider:function(){return l},useClientSession:function(){return d}});var r=n(1352),o=n(8348),i=n(3317),a=n(3910),s=n(9634),c=n(3916);let u=(0,o.createContext)({connected:!1,handoffInFlight:!1,notifications:[],unreadCount:0,markAllRead:()=>{}});function l(e){let{children:t}=e,{isSignedIn:n,getToken:l,sessionId:d}=(0,i.y)(),{user:f}=(0,a.aF)(),[h,m]=(0,o.useState)(),[v,p]=(0,o.useState)(!1),g=(0,o.useRef)(null);(0,o.useEffect)(()=>{!async function(){if(!n||!f){m(void 0),g.current=null;return}if(!d||g.current!==d){p(!0);try{var e,t,r;let n=await l(),o=c.env.NEXT_PUBLIC_API_BASE||"http://localhost:4000/api",i=f.username||(null===(t=f.primaryEmailAddress)||void 0===t?void 0:null===(e=t.emailAddress)||void 0===e?void 0:e.split("@")[0])||"user_".concat(f.id.slice(-6)),a=(null===(r=f.primaryEmailAddress)||void 0===r?void 0:r.emailAddress)||"".concat(f.id,"@placeholder.dev"),s=f.fullName||void 0,u=await fetch("".concat(o,"/users/me"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:n?"Bearer ".concat(n):""},body:JSON.stringify({username:i,email:a,displayName:s,age:18})});if(!u.ok)throw Error("handoff failed");let h=await u.json();h.internalJwt&&(m(h.internalJwt),g.current=d||null)}catch(e){console.warn("[handoff] failed",e)}finally{p(!1)}}}()},[n,f,d,l]);let{connected:b}=function(e){let[t,n]=(0,o.useState)(!1),r=(0,o.useRef)(e);return(0,o.useEffect)(()=>{r.current=e},[e]),(0,o.useEffect)(()=>{if(!r.current)return;let e=(0,s.zp)(r.current),t=()=>n(!0),o=()=>n(!1);return e.on("connect",t),e.on("disconnect",o),()=>{e.off("connect",t),e.off("disconnect",o)}},[r.current]),{connected:t}}(h),[y,w]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=(0,s.hb)();if(!e)return;let t=e=>w(t=>[{...e,read:!1},...t].slice(0,100));return e.on("notification:new",t),()=>{e.off("notification:new",t)}},[b]);let k=(0,o.useMemo)(()=>y.filter(e=>!e.read).length,[y]),x=()=>w(e=>e.map(e=>({...e,read:!0}))),C=(0,o.useMemo)(()=>({internalJwt:h,connected:b,handoffInFlight:v,notifications:y,unreadCount:k,markAllRead:x}),[h,b,v,y,k]);return window.__internalJwt=h,(0,r.jsx)(u.Provider,{value:C,children:t})}function d(){return(0,o.useContext)(u)}},2338:function(e,t,n){"use strict";n.d(t,{NotificationsBell:function(){return s}});var r=n(1352),o=n(6048);let i=(0,n(8452).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var a=n(6883);function s(){let{unreadCount:e}=(0,a.useClientSession)();return(0,r.jsxs)(o.default,{href:"/notifications",className:"relative inline-flex items-center justify-center",children:[(0,r.jsx)(i,{className:"h-5 w-5"}),e>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 h-4 min-w-4 rounded-full bg-emerald-600 text-white text-[10px] leading-4 text-center px-1",children:e>9?"9+":e})]})}},8723:function(e,t,n){"use strict";n.d(t,{ThemeToggle:function(){return u}});var r=n(1352),o=n(8348),i=n(8452);let a=(0,i.Z)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),s=(0,i.Z)("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);var c=n(3160);function u(){let[e,t]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let t=document.documentElement;e?t.classList.add("dark"):t.classList.remove("dark")},[e]),(0,r.jsx)(c.z,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>t(e=>!e),children:e?(0,r.jsx)(a,{className:"h-5 w-5"}):(0,r.jsx)(s,{className:"h-5 w-5"})})}},3160:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(1352),o=n(8348),i=n(3326),a=n(6699),s=n(6735),c=n(2792);let u=(0,a.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:opacity-90",secondary:"bg-secondary text-secondary-foreground hover:opacity-90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:opacity-90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,t)=>{let{className:n,variant:o,size:a,asChild:l=!1,...d}=e,f=l?i.g7:"button";return(0,r.jsx)(f,{className:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.m6)((0,s.W)(t))}(u({variant:o,size:a,className:n})),ref:t,...d})});l.displayName="Button"},9634:function(e,t,n){"use strict";n.d(t,{GO:function(){return l},hb:function(){return c},jl:function(){return u},zp:function(){return s}});var r=n(6006),o=n(3916);let i=null,a=null;function s(e){return i&&i.connected?i:i=(0,r.io)(o.env.NEXT_PUBLIC_SOCKET_URL||"http://localhost:4000",{transports:["websocket"],autoConnect:!0,auth:{token:e}})}function c(){return i}function u(e){if(a&&a.connected)return a;let t=o.env.NEXT_PUBLIC_SOCKET_URL||"http://localhost:4000";return a=(0,r.io)("".concat(t,"/chat"),{transports:["websocket"],autoConnect:!0,auth:{token:e}})}function l(){return a}},8452:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(8348);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),a=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:d,iconNode:f,...h}=e;return(0,r.createElement)("svg",{ref:t,...u,width:o,height:o,stroke:n,strokeWidth:a?24*Number(i)/Number(o):i,className:s("lucide",l),...!d&&!c(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let n=(0,r.forwardRef)((n,i)=>{let{className:c,...u}=n;return(0,r.createElement)(l,{ref:i,iconNode:t,className:s("lucide-".concat(o(a(e))),"lucide-".concat(e),c),...u})});return n.displayName=a(e),n}},829:function(){}},function(e){e.O(0,[505,317,921,6,68,48,98,123,744],function(){return e(e.s=7010)}),_N_E=e.O()}]);