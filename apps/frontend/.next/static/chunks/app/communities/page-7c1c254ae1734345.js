(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{1290:function(e,t,n){Promise.resolve().then(n.bind(n,4571))},4571:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var s=n(1352),a=n(8348),i=n(3317),r=n(3160),l=n(6048),c=n(3916);function o(){let[e,t]=(0,a.useState)([]),[n,o]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!1),[f,m]=(0,a.useState)(""),[h,x]=(0,a.useState)(""),[b,p]=(0,a.useState)("public"),{getToken:g,isSignedIn:v}=(0,i.y)();return(0,a.useEffect)(()=>{let e=c.env.NEXT_PUBLIC_API_BASE||"http://localhost:4000/api";fetch("".concat(e,"/communities")).then(e=>e.ok?e.json():Promise.reject()).then(e=>t(e.items||[])).catch(()=>t([])).finally(()=>o(!1))},[]),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Communities"}),(0,s.jsx)(r.z,{onClick:()=>u(!0),disabled:!v,children:"Create Community"})]}),n?(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loadingâ€¦"}):0===e.length?(0,s.jsx)("p",{className:"text-muted-foreground",children:"No communities yet."}):(0,s.jsx)("ul",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{var t;return(0,s.jsxs)("li",{className:"rounded border p-4",children:[(0,s.jsx)("div",{className:"font-medium",children:(0,s.jsx)(l.default,{href:"/community/".concat(e._id),className:"hover:underline",children:e.name})}),e.description&&(0,s.jsx)("div",{className:"text-muted-foreground text-sm",children:e.description}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:[null!==(t=e.members)&&void 0!==t?t:0," members"]})]},e._id)})}),d&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-background rounded border p-4 w-full max-w-sm space-y-3",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Create Community"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm",children:"Name"}),(0,s.jsx)("input",{className:"w-full border rounded px-2 py-1 bg-background",value:f,onChange:e=>m(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm",children:"Description"}),(0,s.jsx)("textarea",{className:"w-full border rounded px-2 py-1 bg-background",value:h,onChange:e=>x(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm",children:"Visibility"}),(0,s.jsxs)("select",{className:"w-full border rounded px-2 py-1 bg-background",value:b,onChange:e=>p(e.target.value),children:[(0,s.jsx)("option",{value:"public",children:"Public"}),(0,s.jsx)("option",{value:"private",children:"Private"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-1",children:[(0,s.jsx)(r.z,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),(0,s.jsx)(r.z,{onClick:async()=>{let e=c.env.NEXT_PUBLIC_API_BASE||"http://localhost:4000/api",n=await g(),s=await fetch("".concat(e,"/communities"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:n?"Bearer ".concat(n):""},body:JSON.stringify({name:f,description:h,visibility:b})});if(s.ok){let e=(await s.json()).id;t(t=>[{_id:e,name:f,description:h,members:1},...t]),u(!1),m(""),x(""),p("public")}},children:"Create"})]})]})})]})}},3160:function(e,t,n){"use strict";n.d(t,{z:function(){return d}});var s=n(1352),a=n(8348),i=n(3326),r=n(6699),l=n(6735),c=n(2792);let o=(0,r.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:opacity-90",secondary:"bg-secondary text-secondary-foreground hover:opacity-90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:opacity-90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:n,variant:a,size:r,asChild:d=!1,...u}=e,f=d?i.g7:"button";return(0,s.jsx)(f,{className:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.m6)((0,l.W)(t))}(o({variant:a,size:r,className:n})),ref:t,...u})});d.displayName="Button"},8490:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{cancelIdleCallback:function(){return s},requestIdleCallback:function(){return n}});let n="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},s="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},function(e){e.O(0,[317,68,48,98,123,744],function(){return e(e.s=1290)}),_N_E=e.O()}]);