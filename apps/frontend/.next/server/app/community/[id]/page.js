(()=>{var e={};e.id=673,e.ids=[673],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},1282:e=>{"use strict";e.exports=require("child_process")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1437:e=>{"use strict";e.exports=require("zlib")},6005:e=>{"use strict";e.exports=require("node:crypto")},7561:e=>{"use strict";e.exports=require("node:fs")},9411:e=>{"use strict";e.exports=require("node:path")},9198:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>l}),r(9154),r(6126),r(3498);var s=r(9658),i=r(9678),n=r(321),a=r.n(n),o=r(1519),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(t,c);let l=["",{children:["community",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9154)),"/workspaces/prico/apps/frontend/app/community/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6126)),"/workspaces/prico/apps/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,3498,23)),"next/dist/client/components/not-found-error"]}],d=["/workspaces/prico/apps/frontend/app/community/[id]/page.tsx"],u="/community/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/community/[id]/page",pathname:"/community/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},5733:(e,t,r)=>{Promise.resolve().then(r.bind(r,772))},772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(4633),i=r(5608),n=r(6426),a=r(13),o=r(7815);function c({params:e}){let t=process.env.NEXT_PUBLIC_API_BASE||"http://localhost:4000/api",[r,c]=(0,i.useState)(null),[l,d]=(0,i.useState)(""),[u,p]=(0,i.useState)([]),[x,m]=(0,i.useState)(""),[h,f]=(0,i.useState)({}),g=(0,i.useRef)(null),{getToken:v,isSignedIn:y}=(0,n.y)();async function j(){let r=await v();await fetch(`${t}/communities/${e.id}/join`,{method:"POST",headers:{Authorization:r?`Bearer ${r}`:""}})}async function b(){let r=await v();await fetch(`${t}/communities/${e.id}/leave`,{method:"POST",headers:{Authorization:r?`Bearer ${r}`:""}})}async function q(){if(x.trim()){try{let e=window.__internalJwt,t=e?(0,o.jl)(e):(0,o.GO)();t&&t.emit("message:new",{channelId:l,content:x})}catch{}m("")}}return r?((0,i.useMemo)(()=>r.channels?.[0]?.channelId||"general",[r]),(0,s.jsxs)("div",{className:"grid gap-4",style:{gridTemplateColumns:"240px 1fr"},children:[(0,s.jsxs)("aside",{className:"border rounded p-2 h-[70vh] overflow-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:r.name}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[r.membersCount," members"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(a.z,{variant:"outline",onClick:j,disabled:!y,children:"Join"}),s.jsx(a.z,{variant:"outline",onClick:b,disabled:!y,children:"Leave"})]})]}),s.jsx("div",{className:"text-xs uppercase tracking-wider text-muted-foreground mb-2",children:"Channels"}),s.jsx("ul",{className:"space-y-1",children:(r.channels||[]).map(e=>s.jsx("li",{children:(0,s.jsxs)("button",{className:`w-full text-left px-2 py-1 rounded ${l===e.channelId?"bg-accent":"hover:bg-accent/60"}`,onClick:()=>d(e.channelId),children:["#",e.name]})},e.channelId))})]}),(0,s.jsxs)("section",{className:"border rounded flex flex-col h-[70vh]",children:[(0,s.jsxs)("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:[u.map(e=>(0,s.jsxs)("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:e.senderId.slice(-6)}),": ",e.content]},e.id)),Object.keys(h).length>0&&s.jsx("div",{className:"text-xs text-muted-foreground",children:"Someone is typing…"})]}),(0,s.jsxs)("div",{className:"border-t p-2 flex gap-2",children:[s.jsx("input",{className:"flex-1 border rounded px-2 py-1 bg-background",value:x,onChange:e=>(function(e){m(e);let t=window.__internalJwt,r=t?(0,o.jl)(t):(0,o.GO)();r&&(r.emit("typing",{channelId:l}),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{r.emit("stop_typing",{channelId:l})},1500))})(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),q())},placeholder:"Message #general"}),s.jsx(a.z,{onClick:q,disabled:!y,children:"Send"})]})]})]})):s.jsx("div",{children:"Loading…"})}},9154:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(1315).createProxy)(String.raw`/workspaces/prico/apps/frontend/app/community/[id]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[933,760],()=>r(9198));module.exports=s})();